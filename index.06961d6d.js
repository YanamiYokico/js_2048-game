const t=new class{constructor(t){this.initialState=t?t.map(t=>[...t]):null,this.initialState?this.board=this.initialState.map(t=>[...t]):this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}moveLeft(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=[...this.board[e]],r=this.MergeOrigRow(s);this.ArraysEqual(s,r)||(this.board[e]=r,t=!0)}t&&(this.addRandomTile(),this.CheckGameStatus())}moveRight(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=[...this.board[e]],r=s.slice().reverse(),a=this.MergeOrigRow(r).reverse();this.ArraysEqual(s,a)||(this.board[e]=a,t=!0)}t&&(this.addRandomTile(),this.CheckGameStatus())}moveUp(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)s.push(this.board[t][e]);let r=this.MergeOrigRow(s);for(let s=0;s<4;s++)this.board[s][e]!==r[s]&&(this.board[s][e]=r[s],t=!0)}t&&(this.addRandomTile(),this.CheckGameStatus())}moveDown(){if("playing"!==this.status)return;let t=!1;for(let e=0;e<4;e++){let s=[];for(let t=0;t<4;t++)s.push(this.board[t][e]);let r=s.slice().reverse(),a=this.MergeOrigRow(r).reverse();for(let s=0;s<4;s++)this.board[s][e]!==a[s]&&(this.board[s][e]=a[s],t=!0)}t&&(this.addRandomTile(),this.CheckGameStatus())}getScore(){return this.score}getState(){return this.board.map(t=>[...t])}getStatus(){return this.status}start(){this.status="playing",this.addRandomTile(),this.addRandomTile()}restart(t=this.initialState){this.initialState=t?t.map(t=>[...t]):null,this.initialState?this.board=this.initialState.map(t=>[...t]):this.board=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.score=0,this.status="idle"}addRandomTile(){let t=[];for(let e=0;e<4;e++)for(let s=0;s<4;s++)0===this.board[e][s]&&t.push({x:e,y:s});if(t.length>0){let{x:e,y:s}=t[Math.floor(Math.random()*t.length)];this.board[e][s]=.9>Math.random()?2:4}}MergeOrigRow(t){let e=[...t];for(let t=0;t<e.length-1;t++)e[t]===e[t+1]&&0!==e[t]&&(e[t]*=2,this.score+=e[t],e[t+1]=0);let s=e.filter(t=>0!==t);for(;s.length<4;)s.push(0);return s}CheckGameStatus(){for(let t of this.board)for(let e of t)if(2048===e){this.status="win";return}for(let t of this.board)if(t.includes(0))return;for(let t=0;t<4;t++)for(let e=0;e<4;e++)if(t<3&&this.board[t][e]===this.board[t+1][e]||e<3&&this.board[t][e]===this.board[t][e+1])return;this.status="lose"}ArraysEqual(t,e){return t.length===e.length&&t.every((t,s)=>t===e[s])}},e=document.querySelector(".game-field"),s=document.querySelector(".game-score"),r=document.querySelector(".button.start"),a=document.querySelector(".message-start"),i=document.querySelector(".message-win"),o=document.querySelector(".message-lose");function l(){let r=e.querySelectorAll(".field-cell"),a=t.getState();r.forEach((t,e)=>{let s=a[Math.floor(e/4)][e%4];t.textContent=0===s?"":s,t.className=`field-cell field-cell--${s}`}),s.textContent=t.getScore()}function d(){let e=t.getStatus();"win"===e?(i.classList.remove("hidden"),o.classList.add("hidden")):"lose"===e?(o.classList.remove("hidden"),i.classList.add("hidden")):(i.classList.add("hidden"),o.classList.add("hidden")),a.classList.add("hidden"),"playing"===e?(r.textContent="Restart",r.classList.add("restart"),r.classList.remove("start")):(r.textContent="Start",r.classList.add("start"),r.classList.remove("restart"))}r.addEventListener("click",function(){t.restart(),t.start(),l(),d(),r.textContent="Restart"}),document.addEventListener("keydown",function(e){if("playing"===t.getStatus()){switch(e.key){case"ArrowLeft":t.moveLeft();break;case"ArrowRight":t.moveRight();break;case"ArrowUp":t.moveUp();break;case"ArrowDown":t.moveDown();break;default:return}l(),d()}}),l();
//# sourceMappingURL=index.06961d6d.js.map
